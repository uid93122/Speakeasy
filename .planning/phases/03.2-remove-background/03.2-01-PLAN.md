---
phase: 03.2
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - gui/src/renderer/index.html
  - gui/src/renderer/src/styles/globals.css
  - gui/src/renderer/src/components/RecordingIndicator.tsx
autonomous: true
must_haves:
  truths:
    - "Recording overlay background is transparent (not black/gray)"
    - "Main dashboard window retains its dark background"
    - "No flash of unstyled content (FOUC) on overlay load"
  artifacts:
    - path: "gui/src/renderer/src/styles/globals.css"
      provides: "Global styles without body background"
    - path: "gui/src/renderer/index.html"
      provides: "HTML root without background classes"
    - path: "gui/src/renderer/src/components/RecordingIndicator.tsx"
      provides: "Clean overlay component without JS style hacks"
  key_links:
    - from: "gui/src/renderer/src/App.tsx"
      to: "MainLayout"
      via: "Route element"
      pattern: "Route.*MainLayout"
---

<objective>
Refactor CSS architecture to scope background styles to the main layout instead of the global body tag. This ensures the recording overlay can be truly transparent.

Purpose: Fixes the issue where the "transparent" overlay renders with a visible background color.
Output: Refactored CSS and component files.
</objective>

<execution_context>
@./.opencode/get-shit-done/workflows/execute-plan.md
@./.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@gui/src/renderer/index.html
@gui/src/renderer/src/styles/globals.css
@gui/src/renderer/src/components/RecordingIndicator.tsx
@gui/src/renderer/src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove global background styles</name>
  <files>gui/src/renderer/index.html, gui/src/renderer/src/styles/globals.css</files>
  <action>
    1. In `gui/src/renderer/index.html`: Remove `bg-gray-900` from the `<body>` class list.
    2. In `gui/src/renderer/src/styles/globals.css`: Remove `@apply bg-[var(--color-bg-primary)]` from the `body` rule. Keep text color and font settings.
  </action>
  <verify>
    grep -L "bg-gray-900" gui/src/renderer/index.html && grep -L "@apply.*bg-\[" gui/src/renderer/src/styles/globals.css
  </verify>
  <done>
    Global background styles are removed from body tags.
  </done>
</task>

<task type="auto">
  <name>Task 2: Cleanup RecordingIndicator hacks</name>
  <files>gui/src/renderer/src/components/RecordingIndicator.tsx</files>
  <action>
    Remove the `useEffect` hook (lines 51-75) that forcefully sets `document.body.style.background = 'transparent'`. 
    Since global styles are gone, this hack is no longer needed and can cause race conditions.
    
    Ensure the outer wrapper `div` in `RecordingIndicator` remains without a background class.
  </action>
  <verify>
    grep -L "document.body.style.background" gui/src/renderer/src/components/RecordingIndicator.tsx
  </verify>
  <done>
    JS-based style injection is removed from the component.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Refactored CSS architecture for transparency</what-built>
  <how-to-verify>
    1. Launch the application (`npm run dev` in gui).
    2. Verify the Main Dashboard still has its dark background (provided by MainLayout).
    3. Trigger the recording overlay (e.g., via hotkey or dev tools).
    4. Verify the overlay is transparent (no black/gray box around the pill).
  </how-to-verify>
  <resume-signal>Type "approved" if transparency works and dashboard looks correct.</resume-signal>
</task>

</tasks>

<output>
After completion, create `.planning/phases/03.2-remove-background/{phase}-{plan}-SUMMARY.md`
</output>
